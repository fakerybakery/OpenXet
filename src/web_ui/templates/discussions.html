{% extends "repo_base.html" %}

{% block title %}Community - {{ full_name }}{% endblock %}

{% block header_actions %}
{% if current_user %}
<a href="/{{ full_name }}/discussions/new" class="btn btn-primary">New Discussion</a>
{% endif %}
{% endblock %}

{% block repo_content %}
<div class="text-secondary text-sm mb-3">{{ discussion_count }} discussion{% if discussion_count != 1 %}s{% endif %}</div>

{% if discussions %}
<div class="card">
    <ul class="list">
        {% for disc in discussions %}
        <li class="list-item" style="flex-direction: column; align-items: flex-start; gap: 6px;">
            <div class="flex items-center gap-2 w-full">
                {% if disc.status == "open" %}
                <svg class="icon text-success" viewBox="0 0 16 16" fill="currentColor" style="flex-shrink: 0;">
                    <path d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>
                    <path d="M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"/>
                </svg>
                {% else %}
                <svg class="icon" viewBox="0 0 16 16" fill="currentColor" style="flex-shrink: 0; color: var(--purple);">
                    <path d="M11.28 6.78a.75.75 0 00-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 00-1.06 1.06l2 2a.75.75 0 001.06 0l3.5-3.5z"/>
                    <path d="M16 8A8 8 0 110 8a8 8 0 0116 0zm-1.5 0a6.5 6.5 0 11-13 0 6.5 6.5 0 0113 0z"/>
                </svg>
                {% endif %}
                <a href="/{{ full_name }}/discussions/{{ disc.id }}" class="flex-1 font-medium">{{ disc.title }}</a>
                <span class="badge">{{ disc.comment_count }}</span>
            </div>
            <div class="text-xs text-muted" style="margin-left: 26px;">
                #{{ disc.id }} &middot; {{ disc.author }} &middot; {{ disc.created_at }}
            </div>
        </li>
        {% endfor %}
    </ul>
</div>
{% else %}
<div class="card">
    <div class="empty">
        <p class="mb-3">No discussions yet</p>
        {% if current_user %}
        <a href="/{{ full_name }}/discussions/new" class="btn btn-primary">Start a discussion</a>
        {% else %}
        <p class="text-sm text-secondary">Sign in to start a discussion</p>
        {% endif %}
    </div>
</div>
{% endif %}
{% endblock repo_content %}
