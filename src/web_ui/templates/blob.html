{% extends "base.html" %}
{% block title %}{{ file_name }} - OpenXet{% endblock %}
{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
<style>
    .code-view { overflow-x: auto; }
    .code-view pre {
        margin: 0;
        padding: 12px;
        background: transparent !important;
        font-family: Consolas, Monaco, 'Courier New', monospace;
        font-size: 12px;
        line-height: 1.5;
    }
    .code-view code { background: transparent !important; }
    .hljs { background: transparent !important; }
</style>

<div class="breadcrumb">
    <a href="/ui/repos">Repositories</a> /
    <a href="/ui/repos/{{ repo_name }}">{{ repo_name }}</a> /
    <a href="/ui/repos/{{ repo_name }}?tab=files&branch={{ ref_name }}">{{ ref_name }}</a>
    {% for crumb in breadcrumbs %} / {% if loop.last %}{{ crumb.name }}{% else %}<a href="/ui/repos/{{ repo_name }}/tree/{{ ref_name }}/{{ crumb.path }}">{{ crumb.name }}</a>{% endif %}{% endfor %}
</div>

<div class="card">
    <div class="file-header">
        <div class="flex items-center gap-2">
            <span>{{ file_name }}</span>
            {% if is_lfs %}
                {% if lfs_status == "chunked" %}<span class="badge badge-green">Xet</span>
                {% elif lfs_status == "processing" %}<span class="badge badge-yellow">Processing</span>
                {% elif lfs_status == "raw" %}<span class="badge badge-blue">LFS</span>
                {% else %}<span class="badge">LFS</span>{% endif %}
            {% endif %}
            <span class="text-muted">{{ size_display }}</span>
            {% if not is_lfs and not is_binary %}<span class="text-muted">{{ line_count }} lines</span>{% endif %}
        </div>
        <div class="flex gap-2">
            {% if not is_lfs and not is_binary %}
            <a href="/ui/repos/{{ repo_name }}/edit/{{ ref_name }}/{{ path }}" class="btn">Edit</a>
            {% endif %}
            {% if is_lfs and lfs_oid %}
            <a href="/{{ repo_name }}.git/info/lfs/objects/{{ lfs_oid }}" class="btn btn-primary">Download</a>
            {% endif %}
        </div>
    </div>
    {% if is_binary %}
    <div class="empty">Binary file not shown</div>
    {% else %}
    <div class="code-view"><pre><code>{{ content }}</code></pre></div>
    {% endif %}
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
{% endblock %}
