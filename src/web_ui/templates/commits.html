{% extends "repo_base.html" %}
{% block title %}Commits - {{ full_name }} - OpenXet{% endblock %}

{% block header_actions %}
{% if branches %}
<select name="branch" class="select" onchange="window.location.href='/{{ full_name }}/commits/' + this.value">
    {% for branch in branches %}
    <option value="{{ branch.name }}" {% if branch.name == ref_name %}selected{% endif %}>{{ branch.name }}</option>
    {% endfor %}
</select>
{% endif %}
{% endblock %}

{% block branch_change_handler %}
window.location.href = '/{{ full_name }}/commits/' + branch;
{% endblock %}

{% block repo_content %}
<div class="card">
    {% if commits %}
    <ul class="list">
        {% for commit in commits %}
        <li class="list-item justify-between">
            <div style="flex: 1; min-width: 0;">
                <div class="truncate">
                    <a href="/{{ full_name }}/commit/{{ commit.id }}">{{ commit.short_message }}</a>
                </div>
                <div class="text-xs text-muted mt-1">
                    {{ commit.author_name }} &middot; {{ commit.author_time_ago }}
                </div>
            </div>
            <a href="/{{ full_name }}/commit/{{ commit.id }}" class="font-mono text-sm" style="padding: 2px 8px; background: var(--bg-elevated); border-radius: var(--radius-sm); color: var(--text-secondary);">{{ commit.short_id }}</a>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <div class="empty">No commits found</div>
    {% endif %}
</div>

{% if has_prev or has_next %}
<div class="flex items-center justify-center gap-3 mt-3">
    {% if has_prev %}
    <a href="/{{ full_name }}/commits/{{ ref_name }}?page={{ page - 1 }}" class="btn">Previous</a>
    {% endif %}
    <span class="text-sm text-muted">Page {{ page }}</span>
    {% if has_next %}
    <a href="/{{ full_name }}/commits/{{ ref_name }}?page={{ page + 1 }}" class="btn">Next</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}
