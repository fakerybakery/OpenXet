{#
  Modal Component

  Usage:
    {% include "components/modal.html" %}

  Then in your page, create a modal with:
    <div id="my-modal" class="modal-backdrop" onclick="if(event.target===this) closeModal('my-modal')">
      <div class="modal">
        <div class="modal-header">
          <span class="modal-title">Title</span>
          <button type="button" class="modal-close" onclick="closeModal('my-modal')">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"/>
            </svg>
          </button>
        </div>
        <div class="modal-body">
          Content here
        </div>
        <div class="modal-footer">
          <button type="button" class="btn" onclick="closeModal('my-modal')">Cancel</button>
          <button type="submit" class="btn btn-primary">Submit</button>
        </div>
      </div>
    </div>

  JavaScript API:
    openModal('my-modal')   - Opens the modal
    closeModal('my-modal')  - Closes the modal
#}

<script>
(function() {
  // Modal functions - only define once
  if (window.openModal) return;

  window.openModal = function(id) {
    var modal = document.getElementById(id);
    if (modal) {
      modal.classList.add('open');
      // Focus first input if exists
      var firstInput = modal.querySelector('input:not([type="hidden"]), textarea, select');
      if (firstInput) {
        setTimeout(function() { firstInput.focus(); }, 50);
      }
    }
  };

  window.closeModal = function(id) {
    var modal = document.getElementById(id);
    if (modal) {
      modal.classList.remove('open');
    }
  };

  window.closeAllModals = function() {
    document.querySelectorAll('.modal-backdrop.open').forEach(function(m) {
      m.classList.remove('open');
    });
  };

  // Close modals on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeAllModals();
    }
  });
})();
</script>
