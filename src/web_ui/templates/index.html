{% extends "base.html" %}
{% block title %}OpenXet{% endblock %}
{% block content %}
<div class="flex items-center justify-between mb-4">
    <h1 style="font-size: 18px; font-weight: 600;">Dashboard</h1>
    {% if current_user %}
    <div class="flex gap-2">
        <a href="/-/new-org" class="btn">New Organization</a>
        <a href="/-/new" class="btn btn-primary">New Repository</a>
    </div>
    {% endif %}
</div>

<!-- Stats -->
<div class="flex gap-3 mb-4">
    <div class="card flex-1" style="padding: 16px;">
        <div class="stat">
            <div class="stat-value">{{ total_uploaded }}</div>
            <div class="stat-label">Uploaded</div>
        </div>
    </div>
    <div class="card flex-1" style="padding: 16px;">
        <div class="stat">
            <div class="stat-value">{{ total_stored }}</div>
            <div class="stat-label">Stored</div>
        </div>
    </div>
    <div class="card flex-1" style="padding: 16px;">
        <div class="stat">
            <div class="stat-value" style="color: var(--success);">{{ savings_percent }}%</div>
            <div class="stat-label">Saved</div>
        </div>
    </div>
    <div class="card flex-1" style="padding: 16px;">
        <div class="stat">
            <div class="stat-value">{{ dedup_ratio }}</div>
            <div class="stat-label">Dedup</div>
        </div>
    </div>
</div>

<!-- Repositories -->
{% if repos %}
<div class="card">
    <div class="card-header">Repositories</div>
    <ul class="list">
        {% for repo in repos %}
        <li class="list-item">
            <svg class="icon folder-icon" viewBox="0 0 16 16" fill="currentColor">
                <path d="M2 2.5A2.5 2.5 0 014.5 0h8.75a.75.75 0 01.75.75v12.5a.75.75 0 01-.75.75h-2.5a.75.75 0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75 0 01-1.072 1.05A2.495 2.495 0 012 11.5v-9zm10.5-1V9h-8c-.356 0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25 0 00.4.2l1.45-1.087a.25.25 0 01.3 0L8.6 15.7a.25.25 0 00.4-.2v-3.25a.25.25 0 00-.25-.25h-3.5a.25.25 0 00-.25.25z"/>
            </svg>
            <a href="/{{ repo }}" class="flex-1">{{ repo }}</a>
        </li>
        {% endfor %}
    </ul>
</div>
{% else %}
<div class="card">
    <div class="empty">
        <p class="mb-3">No repositories yet</p>
        {% if current_user %}
        <a href="/-/new" class="btn btn-primary">Create your first repository</a>
        {% else %}
        <p class="text-sm text-secondary mb-2">Sign in to create a repository, or push directly:</p>
        <code>git push http://localhost:8080/username/repo.git main</code>
        {% endif %}
    </div>
</div>
{% endif %}

<!-- Quick Start -->
<div class="card mt-3">
    <div class="card-header">Quick Start</div>
    <div class="card-body">
        <div class="mb-3">
            <div class="text-secondary text-sm mb-1">Clone a repository</div>
            <code>git clone http://localhost:8080/owner/repo.git</code>
        </div>
        <div>
            <div class="text-secondary text-sm mb-1">Push to create new</div>
            <code>git push http://localhost:8080/{% if current_user %}{{ current_user }}{% else %}myuser{% endif %}/my-model.git main</code>
        </div>
    </div>
</div>
{% endblock %}
